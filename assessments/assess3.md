---
title: Assessment 3
layout: page
parent: Assessments
last updated: 2024-11-18T23:52:00
---

# Assessment 3
{: .no_toc }

## Table of Contents
{: .no_toc .text-delta }

1. TOC
{:toc}

## p1: insert data

```sql
use library;
go

-- 1. 插入数据到图书表
INSERT INTO [图书] ([图书编号], [书名], [类别], [出版社], [作者], [定价], [出版日期])
VALUES 
    ('TP0001', '数据结构', '计算机', '机械工业出版社', '敬一明', 50.00, NULL),
    ('TP0002', '计算机应用基础', '计算机', '高等教育出版社', '杨正东', 20.00, NULL),
    ('TP0013', 'SQL Server 2000', '计算机', '大连理工出版社', '叶潮流', 30.00, '2010-01-01'),
    ('TP0004', 'C语言程序设计', '计算机', '清华大学出版社', '谭浩强', 25.00, NULL),
    ('H31001', '实用英语精读', '英语', '中国人大出版社', '张锦芯', 25.00, NULL),
    ('F27505', '管理学概论', '管理', '高等教育出版社', '李道芳', 35.00, '2011-11-01'),
    ('TB0004', '工业管理', '管理', '机械工业出版社', 'Fayol', 70.00, NULL),
    ('O15005', '线性代数', '数学', '机械工业出版社', '李京平', 50.00, NULL),
    ('FO0006', '电子商务', '管理', '机械工业出版社', 'Durark', 14.00, NULL),
    ('TP0038', 'ASP程序设计', '计算机', '水利水电出版社', '叶潮流', 29.00, '2008-10-01');

-- 2. 插入数据到读者类型表
INSERT INTO [读者类型] ([类型编号], [类型名称], [限借数量], [借阅期限])
VALUES 
    (1, '教师', 20, 180),
    (2, '学生', 10, 90);

-- 3. 插入数据到读者表
INSERT INTO [读者] ([读者编号], [姓名], [性别], [单位], [电话], [读者类型], [已借数量])
VALUES 
    (1001, '刘春华', '男', '管理学院', '81234567', 1, NULL),
    (1002, '王新刚', '男', '经济学院', '13829023456', 2, NULL),
    (1003, '何立锋', '女', '管理学院', '13805514067', 2, NULL),
    (1004, '王永平', '男', '文学院', '13908423456', 1, NULL),
    (1005, '周士杰', '女', '教育学院', '13105654567', 1, NULL),
    (1006, '庞丽萍', '男', '数理学院', '1380551****', 1, NULL),
    (1007, '张涵韵', '女', '艺术学院', '1860551****', 2, NULL),
    (1008, '王晓静', '男', '电子学院', '1332901****', 1, NULL),
    (1009, '罗国明', '女', '电子学院', '1320565****', 2, NULL),
    (1010, '李春刚', '男', '机电学院', '1330551****', 2, NULL);

-- 4. 插入数据到借阅表
INSERT INTO [借阅] ([串号], [读者编号], [图书编号], [借书日期], [还书日期])
VALUES 
    (1, 1001, 'TP0001', '2011-10-08', '2011-12-18'),
    (2, 1001, 'TP0002', '2011-10-08', '2011-12-18'),
    (3, 1003, 'TP0013', '2011-09-01', NULL),
    (4, 1004, 'TP0001', '2011-10-26', NULL),
    (5, 1005, 'H31001', '2011-11-23', NULL),
    (6, 1006, 'F27505', '2011-09-18', NULL),
    (7, 1001, 'TB0004', '2010-05-18', NULL),
    (8, 1005, 'O15005', '2012-01-15', NULL),
    (9, 1009, 'FO0006', '2012-01-08', NULL),
    (10, 1006, 'TP0038', '2011-12-20', NULL);
```

## p2: query

1. 查询图书表中书名中包含“程序设计”的图书信息。
2. 查询图书表中“计算机”类别的图书信息，输出结果按出版日期降序排列。
3. 查询图书定价最高的前3个图书的图书编号、书名、定价。
4. 查询各读者在2021-10-1到2022-10-1之间的借阅数量（不能利用读者表的列“已借数量”）。
5. 查询借阅图书次数超过2次的读者编号、借阅数量（不能利用读者表的列“已借数量”）。
6. 使用连接查询，查询“C语言程序设计”图书借阅日期最近的3名读者的读者编号和借书日期。
7. 使用连接查询，查询2021-10-1到2022-10-1之间作者为“谭浩强”的图书的借阅情况。
8. 使用连接查询，查询借阅了《数据结构》图书的读者信息。
9. 使用嵌套查询，查询借阅图书的读者信息。
10. 使用嵌套查询，查询作者所著图书的平均定价大于所有图书的平均定价的作者。

```sql
use library;
go

-- q1: 查询图书表中书名中包含“程序设计”的图书信息
select * from 图书
where 书名 like '%程序设计%';

-- q2: 查询图书表中“计算机”类别的图书信息，输出结果按出版日期降序排列
select * from 图书
where 类别 = '计算机'
order by 出版日期 desc;

-- q3: 查询图书定价最高的前3个图书的图书编号、书名、定价
select top 3 图书编号, 书名, 定价 from 图书
order by 定价 desc;

-- q4: 查询各读者在2021-10-1到2022-10-1之间的借阅数量（不能利用读者表的列“已借数量”）
select 读者编号, count(*) as 借阅数量 from 借阅
where 借书日期 between '2021-10-1' and '2022-10-1'
group by 读者编号;

-- q5: 查询借阅图书次数超过2次的读者编号、借阅数量（不能利用读者表的列“已借数量”）
select 读者编号 count(*) as 借阅数量 from 借阅
group by 读者编号
having count(*) > 2;

-- q6: 使用连接查询，查询“C语言程序设计”图书借阅日期最近的3名读者的读者编号和借书日期
select top 3 借阅.读者编号, 借阅.借书日期 from 借阅
join 读者 on 读者.读者编号 = 借阅记录.读者编号
where 借阅.图书编号 = (select 图书编号 from 图书 where 书名 = 'C语言程序设计')
order by 借阅.借书日期 desc;

-- q7: 使用连接查询，查询2021-10-1到2022-10-1之间作者为“谭浩强”的图书的借阅情况
select 借阅.*, 图书.书名, 图书.作者 from 借阅
join 图书 on 图书.图书编号 = 借阅.图书编号
where 图书.作者 = '谭浩强' and (借阅.借书日期 between '2021-10-01' and '2022-10-01');

-- q8: 使用连接查询，查询借阅了《数据结构》图书的读者信息
select 读者.* from 借阅
join 读者 on 读者.读者编号 = 借阅.读者编号
where 借阅.图书编号 = (select 图书编号 from 图书 where 书名 = '数据结构');

-- q9: 使用嵌套查询，查询借阅图书的读者信息
select * from 读者
where 读者编号 in (select 读者编号 from 借阅);

-- q10: 使用嵌套查询，查询作者所著图书的平均定价大于所有图书的平均定价的作者
select distinct 作者 from 图书
where 作者 is not null and
(select avg(定价) from 图书 as t where T.作者 = 图书.作者) >
(select avg(定价) from 图书);
```
