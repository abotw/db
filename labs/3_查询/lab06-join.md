---
title: "Lab 06: 连接查询 (2h)"
layout: page
parent: Labs
last updated: 2024-11-14T21:01:00
---

# Lab 06: 连接查询 (2h)

## Contents

### 第1关：使用连接查询，查询各读者的姓名和借阅期限

```sql
use library;
go

select 读者.姓名, 读者类型.借阅期限
from 读者
join 读者类型 on 读者.读者类型 = 读者类型.类型编号;
go
```

### 第2关：使用连接查询，查询各读者的姓名、所借书名和借书日期

```sql
use library;
go

select 读者.姓名, 图书.书名, 借阅.借书日期
from 读者
join 借阅 on 读者.读者编号 = 借阅.读者编号
join 图书 on 借阅.图书编号 = 图书.图书编号;
go
```

### 第3关：使用连接查询，查询“C 语言程序设计”图书借书日期最近的3名读者的读者姓名和借书日期

```sql
use library;
go

select top 3 读者.姓名, 借阅.借书日期
from 借阅
join 读者 on 借阅.读者编号 = 读者.读者编号
join 图书 on 借阅.图书编号 = 图书.图书编号
where 图书.书名 = 'C语言程序设计'
order by 借阅.借书日期 desc;
go
```

### 第4关：使用连接查询，查询作者为“胡学钢”的图书在2023-10-1到2024-10-1期间的借阅情况

```sql
use library;
go

select 借阅.读者编号, 借阅.图书编号, 借阅.借书日期, 借阅.还书日期 
from 借阅
join 读者 on 借阅.读者编号 = 读者.读者编号
join 图书 on 借阅.图书编号 = 图书.图书编号
where 图书.作者 = '胡学钢'
    and 借阅.借书日期 between '2023-10-01' and '2024-10-01';
go
```

### +第5关：使用连接查询，查询借阅了书名为“数据库原理与应用“的读者信息

> 使用连接查询，查询==借阅==了==书==名为“数据库原理与应用“的==读者==信息。

```sql
use library;
go

select distinct 读者.读者编号, 读者.姓名, 读者.性别, 读者.单位, 读者.电话, 读者.读者类型, 读者.已借数量
from 读者
join 借阅 on 借阅.读者编号 = 读者.读者编号
join 图书 on 图书.图书编号 = 借阅.图书编号
where 图书.书名 = '数据库原理与应用';
go
```

### 第6关：使用连接查询，查询借阅了图书作者是“谭浩强”的读者信息

```sql
use library;
go

select 读者.读者编号, 读者.姓名, 读者.性别, 读者.单位, 读者.电话, 读者.读者类型, 读者.已借数量
from 读者
join 借阅 on 读者.读者编号 = 借阅.读者编号
join 图书 on 借阅.图书编号 = 图书.图书编号
where 图书.作者 = '谭浩强';
go
```

## Notes

